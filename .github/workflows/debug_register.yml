name: Debug Register Flow

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  debug-register:
    runs-on: ubuntu-latest

    steps:
      # 1Ô∏è‚É£ –ö–û–î–†–û –ú–ï–ì–ò–†–ï–ú
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2Ô∏è‚É£ FLUTTER SETUP
      - name: Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.22.0'
          channel: stable

      # 3Ô∏è‚É£ DEPENDENCIES
      - name: Install dependencies
        run: flutter pub get

      # 4Ô∏è‚É£ STATIC ANALYSIS (–•–ê–¢–û“≤–û–ò –ü–ò–ù“≤–û–ù)
      - name: Analyze project
        run: flutter analyze

      # 5Ô∏è‚É£ UNIT TEST (–ê–ì–ê–† “≤–ê–°–¢)
      - name: Run tests
        run: flutter test || echo "‚ö†Ô∏è No tests or tests failed"

      # 6Ô∏è‚É£ DEBUG PRINT REGISTER CONTROLLER
      - name: Check Register Controller
        run: |
          echo "===== REGISTER CONTROLLER ====="
          sed -n '1,200p' lib/auth/register/register_controller.dart

      # 7Ô∏è‚É£ DEBUG API ENDPOINTS
      - name: Check API Endpoints
        run: |
          echo "===== API ENDPOINTS ====="
          sed -n '1,200p' lib/core/api/api_endpoints.dart

      # 8Ô∏è‚É£ DEBUG ROUTES
      - name: Check App Routes
        run: |
          echo "===== APP ROUTES ====="
          sed -n '1,200p' lib/app/app_routes.dart

      # 9Ô∏è‚É£ ASSETS CHECK (LOGO)
      - name: Verify logo asset exists
        run: |
          if [ -f assets/icon/logo.png ]; then
            echo "‚úÖ Logo exists"
          else
            echo "‚ùå Logo NOT found"
            exit 1
          fi

      # üîü PUBSPEC ASSETS CHECK
      - name: Check pubspec.yaml assets
        run: |
          echo "===== PUBSPEC ASSETS ====="
          grep -n "assets:" -A 10 pubspec.yaml

      # 1Ô∏è‚É£1Ô∏è‚É£ BUILD (ANDROID DEBUG)
      - name: Build APK (debug)
        run: flutter build apk --debug

      # 1Ô∏è‚É£2Ô∏è‚É£ FINAL STATUS
      - name: Debug finished
        run: echo "‚úÖ DEBUG REGISTER WORKFLOW FINISHED"
